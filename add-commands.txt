1. dnf config-manager --add-repo https://download.docker.com/linux/fedora/docker-ce.repo

2. dnf install containerd.io

3. vi /etc/containerd/config.toml (add lines -->)
   [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
     [plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc.options]
       SystemdCgroup = true
       
   remove --> disabled_plugins : cri

4. systemctl restart containerd

5. cat <<EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearch
enabled=1
gpgcheck=1
gpgkey=https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
exclude=kubelet kubeadm kubectl
EOF

6. sudo setenforce 0

7. sudo sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config

8. cat <<EOF | sudo tee /etc/modules-load.d/k8s.conf
overlay
br_netfilter
EOF

9. modprobe -a overlay br_netfilter

10. cat <<EOF | sudo tee /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-iptables  = 1
net.bridge.bridge-nf-call-ip6tables = 1
net.ipv4.ip_forward                 = 1
EOF

11. sysctl --system

12. swapoff -a; sed -i '/swap/d' /etc/fstab //before installing kubelet!!!!!

13. sestatus

14. systemctl restart dbus; systemctl status firewalld

15. firewall-cmd --permanent --add-port=6443/tcp;
   firewall-cmd --permanent --add-port=2379-2380/tcp;
   firewall-cmd --permanent --add-port=10250/tcp;
   firewall-cmd --permanent --add-port=10251/tcp;
   firewall-cmd --permanent --add-port=10252/tcp;
   firewall-cmd --permanent --add-port=10255/tcp;
   firewall-cmd --permanent --add-port=8472/udp;
   firewall-cmd --add-masquerade --permanent;
   firewall-cmd --permanent --add-port=30000-32767/tcp;
   #Nodeport!!!!!
   systemctl status firewalld;
   systemctl restart firewalld;

16. dnf install -y kubelet kubeadm kubectl --disableexcludes=kubernetes

17. kubeadm init

18. systemctl enable --now kubelet


